<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Atheer Research Suite | Ù…Ù†ØµØ© Ø£Ø«ÙŠØ± Ø§Ù„Ø¨Ø­Ø«ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    
    <style>
        :root { --primary: #0f172a; --secondary: #1e293b; --accent: #38bdf8; --text: #f8fafc; --success: #22c55e; --danger: #ef4444; --border: #334155; --nav-height: 60px; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--primary); color: var(--text); margin: 0; padding: 0; overflow: hidden; height: 100vh; width: 100vw; }
        
        /* --- Layout Structure --- */
        .app-layout { display: grid; grid-template-columns: 280px 1fr; height: 100vh; transition: all 0.3s ease; }
        
        /* --- Sidebar / Mobile Navigation --- */
        .sidebar { background: var(--secondary); border-left: 1px solid var(--border); padding: 20px; display: flex; flex-direction: column; z-index: 100; }
        .brand { font-size: 1.4rem; font-weight: bold; color: var(--accent); margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }
        .brand span { color: #fff; }
        .meta { font-size: 0.7rem; color: #94a3b8; margin-bottom: 25px; }
        
        .nav-container { flex-grow: 1; }
        .nav-item { padding: 12px 15px; margin-bottom: 8px; border-radius: 8px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-size: 0.95rem; color: #cbd5e1; }
        .nav-item:hover { background: #334155; color: #fff; }
        .nav-item.active { background: rgba(56, 189, 248, 0.15); color: var(--accent); border-right: 3px solid var(--accent); font-weight: 600; }

        /* --- Control Panel (Settings) --- */
        .control-panel { background: rgba(15, 23, 42, 0.5); padding: 15px; border-radius: 12px; margin-top: auto; border: 1px solid var(--border); }
        .slider-header { display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 10px; }
        input[type=range] { width: 100%; cursor: pointer; accent-color: var(--accent); height: 6px; border-radius: 5px; }
        
        .run-btn { width: 100%; padding: 14px; background: linear-gradient(135deg, var(--accent), #2563eb); border: none; border-radius: 10px; color: white; font-weight: bold; font-size: 1rem; cursor: pointer; margin-top: 15px; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3); }
        .run-btn:active { transform: scale(0.98); }
        .run-btn:disabled { background: #475569; cursor: not-allowed; box-shadow: none; transform: none; opacity: 0.7; }

        /* --- Main Content Area --- */
        .main { padding: 30px; overflow-y: auto; overflow-x: hidden; position: relative; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; padding-bottom: 80px; }
        .section { display: none; animation: fadeIn 0.4s ease-out; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        h2 { border-bottom: 1px solid var(--border); padding-bottom: 15px; margin-top: 0; color: #fff; font-size: 1.3rem; }
        p { color: #94a3b8; line-height: 1.6; font-size: 0.95rem; margin-bottom: 25px; }

        /* --- Stats Cards --- */
        .stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .card { background: var(--secondary); border: 1px solid var(--border); padding: 20px; border-radius: 12px; position: relative; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .card::before { content: ''; position: absolute; top: 0; right: 0; width: 5px; height: 100%; }
        .card.red::before { background: var(--danger); }
        .card.green::before { background: var(--success); }
        .card.blue::before { background: var(--accent); }
        
        .card-val { font-size: 2rem; font-weight: bold; font-family: 'Courier New', monospace; margin: 12px 0; letter-spacing: -1px; }
        .card-lbl { font-size: 0.85rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; }

        /* --- Chart Container --- */
        .chart-box { background: var(--secondary); padding: 15px; border-radius: 12px; border: 1px solid var(--border); height: 300px; margin-bottom: 30px; position: relative; }

        /* --- Terminal Log --- */
        .terminal { background: #0b0f19; padding: 20px; border-radius: 10px; border: 1px solid #334155; font-family: 'Consolas', monospace; height: 350px; overflow-y: auto; font-size: 0.85rem; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        .log { margin-bottom: 8px; border-bottom: 1px solid #1e293b; padding-bottom: 4px; word-wrap: break-word; }
        .ts { color: #64748b; margin-left: 8px; font-size: 0.75rem; }
        .tech { color: #f59e0b; } .info { color: #3b82f6; } .ok { color: #22c55e; } .err { color: #ef4444; }

        /* --- References Box --- */
        .ref-box { background: rgba(30, 41, 59, 0.4); border: 1px solid var(--border); padding: 20px; border-radius: 10px; margin-top: 40px; }
        .ref-item { display: flex; gap: 12px; margin-bottom: 15px; align-items: flex-start; }
        .ref-num { background: var(--secondary); padding: 2px 8px; border-radius: 6px; border: 1px solid var(--border); color: var(--accent); font-weight: bold; font-size: 0.75rem; min-width: 30px; text-align: center; }
        .ref-content h4 { margin: 0 0 4px 0; font-size: 0.9rem; color: #e2e8f0; }
        .ref-content p { margin: 0; font-size: 0.8rem; color: #94a3b8; }
        .ref-link { display: inline-block; margin-top: 6px; font-size: 0.75rem; color: var(--accent); text-decoration: none; border-bottom: 1px dashed var(--accent); transition: all 0.2s; }
        .ref-link:hover { color: #fff; border-bottom-style: solid; }

        /* --- MOBILE RESPONSIVE TWEAKS --- */
        @media (max-width: 768px) {
            .app-layout { grid-template-columns: 1fr; grid-template-rows: 1fr auto; }
            
            /* Hide Desktop Sidebar elements but keep logic */
            .sidebar { 
                position: fixed; bottom: 0; left: 0; right: 0; 
                height: var(--nav-height); 
                padding: 0; flex-direction: row; 
                border-top: 1px solid var(--border); border-left: none; border-right: none;
                justify-content: space-around; align-items: center;
                background: rgba(30, 41, 59, 0.95); backdrop-filter: blur(10px);
                box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
            }
            
            .brand, .meta, .control-panel { display: none; } /* Hide non-nav items in bottom bar */
            
            .nav-item { 
                flex-direction: column; gap: 4px; padding: 8px; margin: 0; 
                border-radius: 0; background: transparent !important; 
                color: #94a3b8; border: none !important; font-size: 0.7rem;
            }
            .nav-item span:first-child { font-size: 1.2rem; margin-bottom: 2px; } /* Icon size */
            .nav-item.active { color: var(--accent); }
            
            /* Main Content Adjustments */
            .main { padding: 20px; padding-bottom: 100px; } /* Extra padding for bottom nav */
            .stats-row { grid-template-columns: 1fr; } /* Stack cards */
            
            /* Mobile Header & Controls Overlay */
            .mobile-header { 
                display: block; position: sticky; top: 0; z-index: 90;
                background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);
                padding: 15px 20px; border-bottom: 1px solid var(--border);
                margin: -20px -20px 20px -20px; 
            }
            
            /* Mobile Settings Panel */
            .mobile-controls {
                margin-top: 20px; padding: 15px; background: var(--secondary); 
                border-radius: 12px; border: 1px solid var(--border);
            }
        }
        
        @media (min-width: 769px) {
            .mobile-header, .mobile-controls-wrapper { display: none; }
        }

    </style>
</head>
<body>

<div class="app-layout">
    
    <div class="sidebar">
        <div class="brand">âš¡ Atheer <span>Lab</span></div>
        <div class="meta">v3.0.1 Mobile</div>

        <div class="nav-container" style="display: contents;">
            <div class="nav-item active" onclick="showSection('performance', this)">
                <span>ğŸ“Š</span> <span>Ø§Ù„Ø£Ø¯Ø§Ø¡</span>
            </div>
            <div class="nav-item" onclick="showSection('feasibility', this)">
                <span>ğŸ› ï¸</span> <span>Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„</span>
            </div>
            <div class="nav-item" onclick="showSection('code', this)">
                <span>ğŸ</span> <span>Ø§Ù„ÙƒÙˆØ¯</span>
            </div>
        </div>

        <div class="control-panel">
            <div class="slider-header">
                <span>ØªØ´ÙˆÙŠØ´ Ø§Ù„Ø´Ø¨ÙƒØ© (Jitter)</span>
                <span id="stressDisplay" style="color: var(--accent)">15%</span>
            </div>
            <input type="range" id="stressInput" min="0" max="40" value="15" oninput="updateStress(this.value)">
            <button class="run-btn" id="runBtn" onclick="runSimulation()">â–¶ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        </div>
    </div>

    <div class="main">
        
        <div class="mobile-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-weight: bold; font-size: 1.2rem; color: var(--accent);">âš¡ Atheer <span style="color:#fff">Lab</span></div>
                <div style="font-size: 0.7rem; color: #64748b; background: #1e293b; padding: 2px 8px; border-radius: 4px;">v3.0.1</div>
            </div>
        </div>

        <div class="mobile-controls-wrapper">
            <div class="mobile-controls">
                <div class="slider-header">
                    <span>âš ï¸ Ù…Ø­Ø§ÙƒØ§Ø© Ø¶ØºØ· Ø§Ù„Ø´Ø¨ÙƒØ© (Packet Loss)</span>
                    <span id="stressDisplayMobile" style="color: var(--accent); font-weight:bold;">15%</span>
                </div>
                <input type="range" id="stressInputMobile" min="0" max="40" value="15" oninput="updateStress(this.value)">
                <button class="run-btn" id="runBtnMobile" onclick="runSimulation()">â–¶ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©</button>
            </div>
        </div>
        
        <div id="performance" class="section active">
            <h2 style="margin-top: 10px;">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ (Benchmark)</h2>
            <p>Ù…Ù‚Ø§Ø±Ù†Ø© Ø­ÙŠØ© Ù„Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© (Latency) Ø¨ÙŠÙ† Ø§Ù„Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ù†ÙÙ‚ Ø§Ù„Ø®Ø§Øµ.</p>
            
            <div class="stats-row">
                <div class="card red">
                    <div class="card-lbl">Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø¹Ø§Ù… (Public)</div>
                    <div class="card-val" id="valPublic" style="color: var(--danger)">0.00s</div>
                    <div class="card-lbl">Status: <span id="statusPublic">Waiting</span></div>
                </div>
                <div class="card green">
                    <div class="card-lbl">Ù†Ø¸Ø§Ù… Ø£Ø«ÙŠØ± (Private APN)</div>
                    <div class="card-val" id="valAtheer" style="color: var(--success)">0.00s</div>
                    <div class="card-lbl">Status: <span id="statusAtheer">Waiting</span></div>
                </div>
                <div class="card blue">
                    <div class="card-lbl">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­Ø³Ù† (Improvement)</div>
                    <div class="card-val" id="valImp">0%</div>
                    <div class="card-lbl">Efficiency Gain</div>
                </div>
            </div>

            <div class="chart-box">
                <canvas id="mainChart"></canvas>
            </div>

            <div class="ref-box">
                <h3 style="margin-top:0; color: #fff; font-size: 1rem;">ğŸ“š Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨Ø­Ø«ÙŠØ© (References)</h3>
                
                <div class="ref-item">
                    <div class="ref-num">[1]</div>
                    <div class="ref-content">
                        <h4>Ookla Speedtest Global Index: Yemen</h4>
                        <p>Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¤ÙƒØ¯ Ø£Ù† Ù…ØªÙˆØ³Ø· Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ø§Ù„Ù…ØªÙ†Ù‚Ù„ ÙÙŠ Ø§Ù„ÙŠÙ…Ù† ÙŠØ¹Ø§Ù†ÙŠ Ù…Ù† ØªØ£Ø®ÙŠØ± (Latency) Ù…Ø±ØªÙØ¹.</p>
                        <a href="https://www.speedtest.net/global-index/yemen" target="_blank" class="ref-link">ğŸ”— Open Source Data</a>
                    </div>
                </div>

                <div class="ref-item">
                    <div class="ref-num">[2]</div>
                    <div class="ref-content">
                        <h4>Internet Society: Pulse Country Report</h4>
                        <p>ØªÙ‚Ø±ÙŠØ± ÙŠÙˆØ«Ù‚ Ù‡Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© (Infrastructure Resilience) ÙˆÙ…Ø¹Ø¯Ù„Ø§Øª Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø©.</p>
                        <a href="https://pulse.internetsociety.org/resilience" target="_blank" class="ref-link">ğŸ”— View Report</a>
                    </div>
                </div>

                <div class="ref-item">
                    <div class="ref-num">[3]</div>
                    <div class="ref-content">
                        <h4>StatCounter: Mobile OS Market Share</h4>
                        <p>Ø¥Ø­ØµØ§Ø¦ÙŠØ© ØªØ«Ø¨Øª Ù‡ÙŠÙ…Ù†Ø© Ù†Ø¸Ø§Ù… Android Ø¨Ù†Ø³Ø¨Ø© 92%ØŒ Ù…Ù…Ø§ ÙŠØ¯Ø¹Ù… Ø§Ø®ØªÙŠØ§Ø± HCE ÙƒØ­Ù„ ØªÙ‚Ù†ÙŠ.</p>
                        <a href="https://gs.statcounter.com/os-market-share/mobile/yemen" target="_blank" class="ref-link">ğŸ”— View Statistics</a>
                    </div>
                </div>
            </div>
        </div>

        <div id="feasibility" class="section">
            <h2>Ø³Ø¬Ù„ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ (Technical Logs)</h2>
            <p>Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª (Technical Handshake) Ø¹Ù„Ù‰ Ù†ÙˆØ§Ø© Android.</p>
            
            <div class="terminal" id="terminal">
                <div class="log"><span class="ts">SYSTEM</span> > Ready. Waiting for simulation trigger...</div>
            </div>
        </div>

        <div id="code" class="section">
            <h2>Ø§Ù„Ù…Ù†Ù‡Ø¬ÙŠØ© (Methodology)</h2>
            <p>Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø© Ø¥Ù„Ù‰ ØªÙˆØ²ÙŠØ¹Ø§Øª Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© (Gaussian Distribution).</p>
            
            <pre><code class="language-python">
# Atheer Simulation Algorithm v2.1 Mobile Optimized
# Parameters derived from [Ookla] and [Internet Society]

import numpy as np

class NetworkSimulation:
    def __init__(self, network_stress_level):
        # Public Internet Configuration (Yemen Baseline)
        self.public_avg_latency = 5.0  # seconds
        self.public_jitter = 2.5       # High instability
        self.packet_loss_prob = network_stress_level / 100.0 

        # Atheer Private APN Configuration
        self.atheer_avg_latency = 0.8  # seconds
        self.atheer_jitter = 0.1       # Very Stable

    def run_public_transaction(self):
        """Simulates public internet congestion"""
        latency = np.random.normal(self.public_avg_latency, self.public_jitter)
        
        # Simulating Packet Loss Penalty
        if np.random.random() < self.packet_loss_prob:
            latency += 5.0 + np.random.normal(2.0, 1.0)
            
        return max(2.0, latency)

    def run_atheer_transaction(self):
        """Simulates dedicated tunnel"""
        # HCE Processing + Tunnel Time
        latency = np.random.normal(self.atheer_avg_latency, self.atheer_jitter)
        return max(0.5, latency)
            </code></pre>
        </div>

    </div>
</div>

<script>
    // --- Chart Initialization ---
    let ctx = document.getElementById('mainChart').getContext('2d');
    let myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Internet (Public)', 'Atheer (Private)'],
            datasets: [{
                label: 'Time (Seconds)',
                data: [0, 0],
                backgroundColor: ['#ef4444', '#22c55e'],
                borderRadius: 8,
                barPercentage: 0.6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                y: { beginAtZero: true, grid: { color: '#334155' }, ticks: { color: '#94a3b8' } },
                x: { ticks: { color: '#e2e8f0', font: { size: 11 } } }
            }
        }
    });

    // --- Navigation Logic ---
    function showSection(id, btn) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        // Activate both desktop and mobile items if they exist
        if(btn) btn.classList.add('active');
        
        // Scroll to top on section change
        document.querySelector('.main').scrollTop = 0;
    }

    // --- Sync Inputs (Desktop & Mobile) ---
    function updateStress(val) {
        // Update labels
        document.getElementById('stressDisplay').innerText = val + '%';
        document.getElementById('stressDisplayMobile').innerText = val + '%';
        
        // Sync sliders
        document.getElementById('stressInput').value = val;
        document.getElementById('stressInputMobile').value = val;
        
        // Color logic
        const color = val > 25 ? '#ef4444' : '#38bdf8';
        document.getElementById('stressDisplay').style.color = color;
        document.getElementById('stressDisplayMobile').style.color = color;
    }

    // --- Terminal Logger ---
    function logToTerminal(msg, type='info') {
        const term = document.getElementById('terminal');
        const time = new Date().toISOString().split('T')[1].slice(0,8);
        const div = document.createElement('div');
        div.className = 'log';
        div.innerHTML = `<span class="ts">[${time}]</span> <span class="${type}">${msg}</span>`;
        term.appendChild(div);
        term.scrollTop = term.scrollHeight;
    }

    // --- Simulation Logic ---
    async function runSimulation() {
        const btns = [document.getElementById('runBtn'), document.getElementById('runBtnMobile')];
        btns.forEach(b => {
            b.disabled = true;
            b.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";
        });

        // Reset Displays
        document.getElementById('terminal').innerHTML = '';
        document.getElementById('valPublic').innerText = '...';
        document.getElementById('valAtheer').innerText = '...';
        
        const stress = parseInt(document.getElementById('stressInput').value) / 100;

        logToTerminal('Initializing Simulation Engine v3.0...', 'info');
        logToTerminal(`Network Stress Level: ${stress * 100}%`, 'tech');
        
        const p1 = simulatePublicNetwork(stress);
        const p2 = simulateAtheerProtocol();

        const [res1, res2] = await Promise.all([p1, p2]);

        // Update UI
        document.getElementById('valPublic').innerText = res1.toFixed(2) + 's';
        document.getElementById('valAtheer').innerText = res2.toFixed(2) + 's';
        
        document.getElementById('statusPublic').innerText = res1 > 8 ? 'Timeout Risk' : 'High Latency';
        document.getElementById('statusPublic').style.color = res1 > 8 ? '#ef4444' : '#f59e0b';
        
        document.getElementById('statusAtheer').innerText = 'Verified';
        document.getElementById('statusAtheer').style.color = '#22c55e';

        const imp = ((res1 - res2) / res1 * 100).toFixed(1);
        document.getElementById('valImp').innerText = imp + '%';
        
        // Update Chart
        myChart.data.datasets[0].data = [res1, res2];
        myChart.update();

        btns.forEach(b => {
            b.disabled = false;
            b.innerText = "â–¶ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±";
        });
    }

    // --- Sim Functions ---
    function simulatePublicNetwork(stress) {
        return new Promise(resolve => {
            let delay = 2000 + (Math.random() * 2500);
            if(Math.random() < stress) {
                setTimeout(() => logToTerminal('âš ï¸ Packet Loss detected on Public Net. Retrying...', 'err'), 800);
                delay += 4000; 
            }
            setTimeout(() => {
                resolve((delay / 1000));
            }, 1800); // Visual delay
        });
    }

    function simulateAtheerProtocol() {
        return new Promise(resolve => {
            const step = (ms, msg, type) => setTimeout(() => logToTerminal(msg, type), ms);
            
            step(200, 'NFC Field Detected (ISO 14443-4)', 'tech');
            step(500, 'SELECT AID (A0000000041010)', 'tech');
            step(800, 'Tunnel: rmnet_data1 (Private APN) Connected', 'info');
            step(1200, 'Payload Sent via IPSec. Bypassing Public Internet.', 'ok');
            step(1500, 'Bank ACK Received.', 'ok');

            setTimeout(() => {
                resolve(0.6 + Math.random() * 0.3);
            }, 1600);
        });
    }
</script>

</body>
</html>
